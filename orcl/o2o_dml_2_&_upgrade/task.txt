В приложенном файле есть скрипт изменений БД в случайном порядке (changes.sql) и создания таблиц (create_schema.sql)

1.	Нужно расширить схему  дополнительными таблицами
2.	Нужно расширить изменения текущих и новых таблиц
Чтобы они соответствовали требованиям ниже. Отлаженные скрипты потом нужно будет прогнать на репликации с оракла на оракл.
Data Requirements
These requirements are for data integrity tests (majority of tests). The scripts must contain:
1.  All supported datatypes for a tested database pair.
2.  Datatypes with user-defined length must be of:
    a.  Maximum length
    b.  Minimal length
    c.  Any intermediate value
3.  Values for such columns must contain:
    a.  Empty values (except for not-null columns).
    b.  Maximum length values, if the maximum length is greater than 1.
    c.  Variable-length values, from 1 to max.
    d.  Boundary values for numeric datatypes and dates.
    e.  Special symbols for character datatypes.
4.  DML operations must include:
    a.  Insert
    	i.  All table columns
    	ii.  Selected columns, if some columns can be nullable
      	     1.  Skipping the first columns
      	     2.  Skipping columns in the middle, for example each second column
      	     3.  Skipping the last columns
    b.  Update
    	i.  All table columns
    	ii.  Selected columns, if some columns can be nullable
      	     1.  Skipping the first columns
      	     2.  Skipping columns in the middle, for example each second column
      	     3.  Skipping the last columns
    c.  Delete

    Cделать более обьемные таблицы с разными длинами столбцов и дописать существующий скрипт заполнения таблиц.


    Минимум для намберов и десятичных это все-таки 1, заполни их как (1,1). Максимум для типа char будет 2000. Для репликации с оракла на оракл пройдет, более короткие придется ставить при репликации на другие типы баз где есть ограничение на сумму длин всех столбцов (сайбез, нетиза), но там и таблицы по другому сгруппируются, придется отдельный тест писать.
Пропустил расширить таймстампы, у них допустима длина от 0 до 9, текущие 6 всего лишь стандарное значение по умолчанию.
Нашла интересную матрицу типов по всем версиям оракла, посмотри, может пригодится и найдешь еще что добавить:
http://www.techonthenet.com/oracle/datatypes.php

После изменений в скрипте заодно попробуй полный тест репликации DML, с оракла на оракл пока, сначала вручную, потом продумать и запрограммировать его в систему автотестов, сочетая доступные шаги и свои скрипты.
Выглядит это обычно так:
- создать схемы на сорсе и таргете
- сделать первичное заполнение сорсовых таблиц
- выполнить инишлсинк
- сверить данные
- запустить изменения на сорсе
- выполнить экстракт и апплай (Варианты: батч мод, когда по очереди нажимаешь кнопки экстракта и апплая. Либо создаешь непрерывное расписание continuous, которое постоянно перечитывает онлайн логи. В системе автотестов доступен только последовательный вызов экстрактора и апплаера.) при ручном тесте при этом смотришь лог выполнения. Если есть ошибки – полновесное описание как проговаривали на собеседовании, отправишь письмом мне.
- после того как изменения закончатся и все отреплицируется нормально, т.е. без ошибок экстактора или апплаера, опять сверяешь данные.
- далее, дляавтотестов нужно сохранить конфигурацию в xml, предварительно скинув sync_scn = -1.

Я не помню отсылала ли тебе сверочный запрос. Запрос для оракла выглядит сейчас довольно просто для большинства типов (кроме лобов), это 
Select count(*) from (
select * from source_tab_name 
minus 
select * from target_tab_name 
union all 
select * from target_tab_name 
minus 
select * from source_tab_name)

его тоже стоит перепрограммировать в более подробный вид, через join и неравенства между столбцами. Типы с флоатом допускают потерю точности в последних знаках и при запросе, приведенном выше, всегда находятся расхождения.
В идеале запрос сверки должен возвращать 0, т.е. ноль расхождений. Если сложно сделать сверку одним запросом, то можно разбить на кучу мелких и запускать по очереди. В системе автотестов есть на выбор шаг сверки данных с пользовательским sql, как раз для этого. Можно сделать несколько шагов с такой сверкой, загружая разные запросы. В оракле сравнение  Null и реального значения дает true,стоит иметь ввиду и не забывать оборачивать в nvl() или ставить допоплнительную проверку на is null. В разных СУБД нулловые значения обрабатываются по разному, это бывает значимо при написании запросов.

Для автотестов: назовешь o2o_dml_2 (в siute=DML), это кажется еще не занятое название, в описании – цель проверки, что именно проверяется этим тестом, что мы можем со спокойной совестью отдать пользоваться клиентам. На английском. Если еще при ручном тестировании выяснлись ошибки по каким либо типам, то в автотесты добавишь не один, а два теста – первый только с тем что реплицировалось без ошибок, второй – создав новые таблицы и дмл для тех типов, что оказались с ошибками.
В приложенном файле – небольшой юзергайд по автотестам, логин и пароль должны быть BubnovMaxim


привет, вот занимаюсь репликацией с оракла на оракл 15:18 
Farida Abdullina:  
ты в марте совсем не будешь или с какого-то числа или после какого-то числа? 15:18 
Maxim Bubnov:  
что за ошибка Unable to initialize PostTaskExecutor. 15:18 
Farida Abdullina:  
инишлсинка не было? 15:19 
Maxim Bubnov:  
пока точно не знаю 15:19 
был  15:19 
данные реплицировались  15:19 
это во время аплая  15:20 
Farida Abdullina:  
завершается с ошибкой или просто сообщение? 15:21 
Maxim Bubnov:  
с ошибкой 15:21 
а нет никакой документации по списку ошибок, которые могут произойти во время репликации?  15:22 
Farida Abdullina:  
неа. приходится напрямую дергать девелоперов. 15:22 
Maxim Bubnov:  
еще один вопрос, как автоматизировать проверку данных на сорсе и на таргете? 15:24 
Farida Abdullina:  
если возникают ошибки - лучше не ждать, а сразу спрашивать. пришли полный лог апплаера балову саше, где была ошибка Unable to initialize PostTaskExecutor 15:26 
Maxim Bubnov:  
ок 15:26 
Farida Abdullina:  
проверки - как запрограммируешь. если базы однородны (оракл-оракл) и схема лежит в пределах одной БД, то можно пользоваться селектами, шаблон запроса я писала. если базы неоднородны, то вместо случайной генерации данных лучше использовать фиксированный набор изменений, а на таргете иметь контрольную таблицу с данными, которые должны оказаться на момент окончания репликации, затем так же запросами сверить новые и контрольные значения 15:33 
в письме с логом меня тоже в копию поставь плз  15:33 
за пару дней успеешь закончить? со след. недели  должно начаться уже активное тестирование следующей версии и нужно будет держать темп, успевать с проверками в заданное время. 15:38 
Maxim Bubnov:  
даже и не знаю, пока что-то не очень получается, постоянно то одна ошибка то другая) 15:39 
Farida Abdullina:  
ты завтра во сколько придешь? давай после митинга я подойду и вместе прогоним один цикл репликации. если ты делаешь на сборке 9.5.1, то она и впрямь может быть глючная. пока подумай как будешь делать проверку и попробуй за сегодня уже запрограммировать. могу скинуть в качестве примера не оракловый запрос, но принцип написания по нему понятен. 15:41 
Maxim Bubnov:  
у меня сейчас 9.5.0 15:44 
завтра скорей всего часам к трем  15:45 
Farida Abdullina:  
оки, значит посидим после обеда. у тебя  ж в логе написано что таблица для рекавера не создалась. видимо надо будет в общем пройтись еще раз по ключевым обьектам ИДР, т.к. и тебя и свету я собираюсь использовать для проверки несколько нетривиальных конфигураций 15:55 
Maxim Bubnov:  
из-за чего это может быть? 15:58 
Farida Abdullina:  
не создалась такая таблица при сохранении конфига. надо смотреть на каком шаге оно создается. можно пересоздать через редактирование, это закладка в advanced settings 16:03 
Maxim Bubnov:  
все, разобрался, создал таблицу как в документации 16:04 
Farida Abdullina:  
оки ) я тебе скинула скрипты запросов, как было и как хотелось бы видеть 16:04 
Maxim Bubnov:  
получил) 


В приложенном файле – проверка таблиц мсскл и старая проверка таблиц оракла

Логика проверки такова:
1.	Количество записей в обеих таблицах должно быть одинаково
2.	Для каждого столбца не должно быть несовпадений во второй таблице 
Ну и не забывать про nvl

---

привет. нет. у тебя в задачах нет такого апгрейда. света не успевает проверить все в конфликт резолюшн, я перекинула на тебя программирование конфликтов для ДБ2. свяжись в ольгой фроловой, она поможет поставить дб2 и подконнектиться 
в документации есть немного описания конфликтов, можешь еще у Светы поспрашивать како на делала и Олю спрашивать как скрипты автотестов готовить именно под ДБ2 


Scope

In a partitioned database environment, this command affects all database partitions that are listed in the db2nodes.cfg file.

The database partition from which this command is issued becomes the catalog database partition for the new database.
Authorization

Обязательные шаги:

Нельзя соединиться с экземпляром DB2 "DB2" через порт с номером "50000". Запишите это на будущее.


Необязательные шаги:

Чтобы проверить файлы установки, экземпляр и функции баз данных, запустите инструмент проверки, C:\Program Files\IBM\SQLLIB\bin\db2val.exe. Дополнительную информацию смотрите в описании "db2val" в Информационном центре DB2.

У вас должны быть правильные лицензии для продуктов и возможностей DB2, установленных на этом компьютере. Каждый продукт или возможность DB2 поставляется с файлом сертификата лицензии (его называют также лицензионным ключом), который распространяется на компакт-диске активации вместе с инструкциями по применению этого файла лицензии. Если вы приобрели базовый продукт DB2 вместе с поставляемыми за отдельную плату возможностями, вам может понадобиться установить несколько сертификатов лицензий. Если компакт-диск активации для вашего продукта или возможности не входит в состав пакета носителей, который вы получили от IBM, его можно загрузить с сайта Passport Advantage. Дополнительную информацию о лицензировании можно найти в Информационном центре DB2 (http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/index.jsp), выполнив поиск по таким словам, как "licensing" ("лицензирование") или "db2licm".

Убедитесь, что у вас есть доступ к Информационному центру DB2 в положении, указанном вами во время установки. Если вы выполняли типичную или минимальную установку, убедитесь, что у вас есть доступ к сайту IBM через Интернет.

Просмотрите файл ответов, созданный в C:\Users\mbubnov\Documents\PROD_ESE.rsp. Дополнительную информацию об установке с помощью файла ответов смотрите в разделе документации по DB2 "Обзор установки DB2 с помощью файла ответов".

Информацию о новых функциях DB2 V9.7 смотрите в теме "Что нового" http://publib.boulder.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.wn.doc/doc/c0052035.html в Информационном центре DB2.

